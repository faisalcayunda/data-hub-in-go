# ============================================================================
# Portal Data API - Environment Configuration
# ============================================================================
# Copy this file to .env and update with your actual values
# cp env.example .env

# ============================================================================
# APPLICATION SETTINGS
# ============================================================================
PROJECT_NAME="Portal Data"
VERSION="0.1.0"
DESCRIPTION="Portal Data API"
TIMEZONE="Asia/Jakarta"

# ============================================================================
# SERVER SETTINGS
# ============================================================================
# Debug mode: Enable for development, disable for production
DEBUG=false

# Server host and port
HOST=0.0.0.0
PORT=5000

# Number of worker processes
# Recommended: (2 * CPU_CORES) + 1
# Leave empty to auto-calculate based on CPU cores
WORKERS=

# Logging level: debug, info, warning, error, critical
LOG_LEVEL=info

# Event loop: asyncio or uvloop
# Note: uvloop not yet compatible with Python 3.14
LOOP=asyncio

# HTTP protocol implementation
HTTP=httptools

# ============================================================================
# PERFORMANCE SETTINGS
# ============================================================================
# Maximum number of concurrent connections
LIMIT_CONCURRENCY=100

# Socket backlog (number of pending connections)
BACKLOG=2048

# Maximum requests per worker before restart (prevents memory leaks)
# Set to 0 or leave empty to disable
LIMIT_MAX_REQUESTS=

# Keep-alive timeout in seconds
TIMEOUT_KEEP_ALIVE=5

# Maximum incomplete HTTP event size
H11_MAX_INCOMPLETE_EVENT_SIZE=16384

# ============================================================================
# HEADERS CONFIGURATION
# ============================================================================
# Custom server header (leave empty for default: "PROJECT_NAME/VERSION")
SERVER_HEADER=

# Enable/disable date header
DATE_HEADER=true

# Forwarded allow IPs (for proxy/load balancer support)
# Use "*" to allow all, or specify comma-separated IPs
FORWARDED_ALLOW_IPS=*

# ============================================================================
# CORS SETTINGS
# ============================================================================
# Allowed origins (comma-separated)
# Use "*" to allow all origins (not recommended for production)
ALLOWED_ORIGINS=*

# ============================================================================
# DATABASE SETTINGS
# ============================================================================
# PostgreSQL connection URL
DATABASE_URL=postgresql+asyncpg://user:password@localhost:5432/portal_data

# Database pool settings
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=10
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=3600

# ============================================================================
# REDIS SETTINGS
# ============================================================================
# Redis connection URL
REDIS_URL=redis://localhost:6379/0

# Redis pool settings
REDIS_POOL_SIZE=10
REDIS_MAX_CONNECTIONS=50

# ============================================================================
# STORAGE SETTINGS (MinIO/S3)
# ============================================================================
# MinIO/S3 endpoint
MINIO_ENDPOINT=localhost:9000
MINIO_ACCESS_KEY=minioadmin
MINIO_SECRET_KEY=minioadmin
MINIO_SECURE=false
MINIO_BUCKET=portal-data

# ============================================================================
# SECURITY SETTINGS
# ============================================================================
# Secret key for JWT tokens (generate with: openssl rand -hex 32)
SECRET_KEY=your-secret-key-here-change-this-in-production

# JWT algorithm
ALGORITHM=HS256

# Access token expiration in minutes
ACCESS_TOKEN_EXPIRE_MINUTES=30

# Refresh token expiration in days
REFRESH_TOKEN_EXPIRE_DAYS=7

# Password hashing
PASSWORD_SCHEME=argon2

# ============================================================================
# RATE LIMITING
# ============================================================================
# Rate limit: requests per minute
RATE_LIMIT=100

# Rate limit storage backend
RATE_LIMIT_STORAGE=redis://localhost:6379/1

# ============================================================================
# TRINO SETTINGS
# ============================================================================
# Trino connection settings
TRINO_HOST=localhost
TRINO_PORT=8080
TRINO_USER=trino
TRINO_CATALOG=hive
TRINO_SCHEMA=default

# ============================================================================
# MONITORING & LOGGING
# ============================================================================
# Enable access logs
ACCESS_LOG=false

# Log file path (leave empty for stdout)
LOG_FILE=

# Sentry DSN for error tracking
SENTRY_DSN=

# ============================================================================
# FEATURE FLAGS
# ============================================================================
# Enable/disable specific features
ENABLE_SWAGGER=true
ENABLE_REDOC=true
ENABLE_METRICS=false
ENABLE_TRACING=false

# ============================================================================
# THREADING CONFIGURATION (Python 3.14)
# ============================================================================
# Threading settings for Python 3.14 optimization
# These settings enable better concurrency with threads

# Number of threads per worker process
# Recommended: 2-8 threads per worker
THREADS=4

# Enable thread-based workers
# Set to true to enable threading (recommended for Python 3.14)
THREAD_WORKERS=true

# Thread pool size for async operations
THREAD_POOL_SIZE=8

# Python 3.14 GIL optimization settings
PYTHON_GIL=1
PYTHON_THREADING=1

# ============================================================================
# GUNICORN-SPECIFIC SETTINGS
# ============================================================================
# These settings are used by gunicorn.conf.py
# Most are derived from the settings above

# Gunicorn timeout (seconds)
GUNICORN_TIMEOUT=120

# Graceful timeout (seconds)
GUNICORN_GRACEFUL_TIMEOUT=30

# Max requests per worker (0 to disable)
GUNICORN_MAX_REQUESTS=1000

# Max requests jitter
GUNICORN_MAX_REQUESTS_JITTER=50

# Worker connections
GUNICORN_WORKER_CONNECTIONS=1000

# Worker class
GUNICORN_WORKER_CLASS=uvicorn.workers.UvicornWorker

# ============================================================================
# CONVEX SETTINGS
# ============================================================================
# Convex backend host/IP address
# This is used for CONVEX_CLOUD_ORIGIN and CONVEX_SITE_ORIGIN
CONVEX_HOST=103.127.98.75

# Convex backend port (default: 3210 in docker-compose.yml)
# Note: This uses PORT variable, but docker-compose has default 3210
# PORT=3210

# Convex site proxy port (default: 3211 in docker-compose.yml)
# SITE_PROXY_PORT=3211

# Convex admin key
CONVEX_ADMIN_KEY=

# PostgreSQL URL for Convex
POSTGRES_URL=

# Convex dashboard port
DASHBOARD_PORT=6791

# Convex deployment URL
NEXT_PUBLIC_DEPLOYMENT_URL=

# Disable SSL requirement
DO_NOT_REQUIRE_SSL=

# Disable beacon
DISABLE_BEACON=

# Document retention delay
DOCUMENT_RETENTION_DELAY=
